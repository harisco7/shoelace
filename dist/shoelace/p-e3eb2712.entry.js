import{r as t,c as i,h as s}from"./p-bf36b983.js";var e=function(t,i,s,e){return new(s||(s=Promise))((function(o,n){function r(t){try{a(e.next(t))}catch(t){n(t)}}function l(t){try{a(e.throw(t))}catch(t){n(t)}}function a(t){var i;t.done?o(t.value):(i=t.value,i instanceof s?i:new s((function(t){t(i)}))).then(r,l)}a((e=e.apply(t,i||[])).next())}))};const o=class{constructor(s){t(this,s),this.slSubmit=i(this,"sl-submit",7),this.novalidate=!1}connectedCallback(){this.formControls=[{tag:"button",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null,click:t=>{"submit"===t.target.type&&this.submit()}},{tag:"input",serialize:(t,i)=>{t.name&&!t.disabled&&("checkbox"!==t.type&&"radio"!==t.type||t.checked)&&("file"!==t.type?i.append(t.name,t.value):[...t.files].map((s=>i.append(t.name,s))))},click:t=>{"submit"===t.target.type&&this.submit()},keyDown:t=>{"Enter"!==t.key||t.defaultPrevented||["checkbox","file","radio"].includes(t.target.type)||this.submit()}},{tag:"select",serialize:(t,i)=>{if(t.name&&!t.disabled)if(t.multiple){const s=[...t.querySelectorAll("option:checked")];s.length?s.map((s=>i.append(t.name,s.value))):i.append(t.name,"")}else i.append(t.name,t.value)}},{tag:"sl-button",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null,click:t=>{t.target.submit&&this.submit()}},{tag:"sl-checkbox",serialize:(t,i)=>t.name&&t.checked&&!t.disabled?i.append(t.name,t.value):null},{tag:"sl-color-picker",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null},{tag:"sl-input",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null,keyDown:t=>{"Enter"!==t.key||t.defaultPrevented||this.submit()}},{tag:"sl-radio",serialize:(t,i)=>t.name&&t.checked&&!t.disabled?i.append(t.name,t.value):null},{tag:"sl-range",serialize:(t,i)=>{t.name&&!t.disabled&&i.append(t.name,t.value+"")}},{tag:"sl-select",serialize:(t,i)=>{if(t.name&&!t.disabled)if(t.multiple){const s=[...t.value];s.length?s.map((s=>i.append(t.name,s))):i.append(t.name,"")}else i.append(t.name,t.value+"")}},{tag:"sl-switch",serialize:(t,i)=>t.name&&t.checked&&!t.disabled?i.append(t.name,t.value):null},{tag:"sl-textarea",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null},{tag:"textarea",serialize:(t,i)=>t.name&&!t.disabled?i.append(t.name,t.value):null}],this.handleClick=this.handleClick.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}getFormData(){return e(this,void 0,void 0,(function*(){const t=new FormData;return(yield this.getFormControls()).map((i=>this.serializeElement(i,t))),t}))}getFormControls(){return e(this,void 0,void 0,(function*(){const t=this.form.querySelector("slot"),i=this.formControls.map((t=>t.tag));return t.assignedElements({flatten:!0}).reduce(((t,i)=>t.concat(i,[...i.querySelectorAll("*")])),[]).filter((t=>i.includes(t.tagName.toLowerCase())))}))}submit(){return e(this,void 0,void 0,(function*(){const t=yield this.getFormData(),i=yield this.getFormControls(),s=i.filter((t=>"function"==typeof t.reportValidity));if(!this.novalidate)for(const t of s)if(!(yield t.reportValidity()))return!1;return this.slSubmit.emit({formData:t,formControls:i}),!0}))}handleClick(t){const i=t.target.tagName.toLowerCase();for(const s of this.formControls)s.tag===i&&s.click&&s.click(t)}handleKeyDown(t){const i=t.target.tagName.toLowerCase();for(const s of this.formControls)s.tag===i&&s.keyDown&&s.keyDown(t)}serializeElement(t,i){const s=t.tagName.toLowerCase();for(const e of this.formControls)if(e.tag===s)return e.serialize(t,i);return null}render(){return s("div",{ref:t=>this.form=t,part:"base",class:"form",role:"form",onClick:this.handleClick,onKeyDown:this.handleKeyDown},s("slot",null))}};o.style=":host{position:relative;box-sizing:border-box}:host *,:host *:before,:host *:after{box-sizing:inherit}:host{display:block}";export{o as sl_form}